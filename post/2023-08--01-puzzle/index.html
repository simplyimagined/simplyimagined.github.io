<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>Designing the Puzzle Component - </title>

  <meta name="description" content="Some toil, some trouble, and we get a puzzle">
  <meta name="author" content="Dan Anderson"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Simply Imagined",
    
    "url": "https:\/\/simplyimagined.github.io"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/simplyimagined.github.io"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/simplyimagined.github.io",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/simplyimagined.github.io\/post\/2023-08--01-puzzle\/",
          "name": "Designing the puzzle component"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Dan Anderson"
  },
  "headline": "Designing the Puzzle Component",
  "description" : "After deciding to do a clone of what is perhaps the most popular word game, I realized that never having played it could be a liability. I\u0026rsquo;d heard descriptions, seen everyone post their score pictures to Twitter, and read up on strategy. I\u0026rsquo;ve yet to even open the website. Let\u0026rsquo;s get started!\n",
  "inLanguage" : "en",
  "wordCount":  1510 ,
  "datePublished" : "2023-08-01T11:43:31",
  "dateModified" : "2023-08-01T11:43:31",
  "image" : "https:\/\/simplyimagined.github.io\/images\/simply_imagined_tree.png",
  "keywords" : [ "subtle, puzzle, design" ],
  "mainEntityOfPage" : "https:\/\/simplyimagined.github.io\/post\/2023-08--01-puzzle\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/simplyimagined.github.io",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/simplyimagined.github.io\/images\/simply_imagined_tree.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Designing the Puzzle Component" />
<meta property="og:description" content="Some toil, some trouble, and we get a puzzle">
<meta property="og:image" content="https://simplyimagined.github.io/images/simply_imagined_tree.png" />
<meta property="og:url" content="https://simplyimagined.github.io/post/2023-08--01-puzzle/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Simply Imagined" />

  <meta name="twitter:title" content="Designing the Puzzle Component" />
  <meta name="twitter:description" content="Some toil, some trouble, and we get a puzzle">
  <meta name="twitter:image" content="https://simplyimagined.github.io/images/simply_imagined_tree.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="generator" content="Hugo 0.117.0">
  <link rel="alternate" href="https://simplyimagined.github.io/index.xml" type="application/rss+xml" title="Simply Imagined"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="https://simplyimagined.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://simplyimagined.github.io/css/syntax.css" /><link rel="stylesheet" href="https://simplyimagined.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://simplyimagined.github.io">Simply Imagined</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Blog" href="/post/">Blog</a>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent">Subtle</a>
              <div class="navlinks-children">
                
                  <a href="/page/subtle/">The Project</a>
                
                  <a href="https://subtle.fly.dev">Let&#39;s Play!</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Simply Imagined" href="https://simplyimagined.github.io">
            <img class="avatar-img" src="https://simplyimagined.github.io/images/simply_imagined_tree.png" alt="Simply Imagined" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  
    <div id="header-big-imgs" data-num-img=1
      
         
          data-img-src-1="/images/verne-inspect-b.png"
         
         data-img-desc-1="Puzzling"
      ></div>
  

  <header class="header-section has-img">
    
      
      <div class="intro-header big-img" style="background-image: url('/images/verne-inspect-b.png');">
        
        <div class="container">
          <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <div class="post-heading">
                <h1>Designing the Puzzle Component</h1>
                  
                    
                      <h2 class="post-subheading">Some toil, some trouble, and we get a puzzle</h2>
                    
                  
                  
                    <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on August 1, 2023
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;8&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1510&nbsp;words
  
  
  
</span>


                  
              </div>
            </div>
          </div>
        </div>
        <span class="img-desc" style="display: inline;">Puzzling</span>
      </div>
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Designing the Puzzle Component</h1>
              
              
              
                
                  <h2 class="post-subheading">Some toil, some trouble, and we get a puzzle</h2>
                
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on August 1, 2023
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;8&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;1510&nbsp;words
  
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>After deciding to do a clone of what is perhaps the most popular word game, I realized that never having played it could be a liability. I&rsquo;d heard descriptions, seen everyone post their score pictures to Twitter, and read up on strategy. I&rsquo;ve yet to even open the website. Let&rsquo;s get started!</p>
<h3 id="the-basics">The Basics</h3>
<p>The basics of the game involve guessing a five letter word &ndash; five letters, six tries to guess it, and some help along the way. There is a grid where the columns contain the letters and the rows are each guess. After each guess the letters are colored to indicate if the letter is in the <em>correct</em> position, <em>somewhere else</em> or <em>not in the answer</em>.</p>
<p>To get started we need a struct to hold the current state of the game, the answer, and the guesses. The list of guesses also contains the results of those guesses.</p>
<p>Let&rsquo;s create a sample puzzle with an answer &ldquo;paper&rdquo;.</p>
<pre tabindex="0"><code>iex&gt; puzzle = Puzzle.new(answer: &#34;paper&#34;)
%Subtle.Puzzle{
  state: :playing,
  word_length: 5,
  max_guesses: 6,
  answer: &#34;paper&#34;,
  guesses: []
}
</code></pre><p>Now let&rsquo;s guess the word &ldquo;apple&rdquo;.</p>
<pre tabindex="0"><code>iex&gt; Puzzle.make_guess(puzzle, &#34;apple&#34;)
{:ok,
 %Subtle.Puzzle{
   state: :playing,
   word_length: 5,
   max_guesses: 6,
   answer: &#34;paper&#34;,
   guesses: [
     %Subtle.Guess{
       guess: &#34;apple&#34;,
       results: [
         {&#34;a&#34;, :wrong_position},
         {&#34;p&#34;, :wrong_position},
         {&#34;p&#34;, :correct},
         {&#34;l&#34;, :wrong_letter},
         {&#34;e&#34;, :wrong_position}
       ]
     }
   ]
 }}
</code></pre><p>Here you can see a new structure, <strong>Subtle.Guess</strong>, added to our list of guesses. It contains the word guessed and the results for each letter. In this case:</p>
<ul>
<li>&ldquo;a&rdquo;, in the answer but not here</li>
<li>&ldquo;p&rdquo;, in the answer but not here</li>
<li>&ldquo;p&rdquo;, correct letter for this location</li>
<li>&ldquo;l&rdquo;, there is no &ldquo;l&rdquo; in the answer</li>
<li>&ldquo;e&rdquo;, another correct letter but not here</li>
</ul>
<p>By building up the list after each guess we can beautify and clarify this information on the LiveView.</p>
<h3 id="letter-comparison">Letter Comparison</h3>
<p>The heart of <strong>Guess</strong> is <em>compare_letters</em>. Its job is to compare the guess with the answer and return a list with the results for each letter pair. As an example with the answer &ldquo;paper&rdquo; and a guess &ldquo;apple&rdquo; here is what happens:</p>
<ul>
<li>Convert the words into grapheme lists:</li>
</ul>
<blockquote>
<p>[&ldquo;a&rdquo;, &ldquo;p&rdquo;, &ldquo;p&rdquo;, &ldquo;l&rdquo;, &ldquo;e&rdquo;], [&ldquo;p&rdquo;, &ldquo;a&rdquo;, &ldquo;p&rdquo;, &ldquo;e&rdquo;, &ldquo;r&rdquo;]</p>
</blockquote>
<ul>
<li>Then zip these together so we can process them as pairs:</li>
</ul>
<blockquote>
<p>[{&ldquo;a&rdquo;, &ldquo;p&rdquo;}, {&ldquo;p&rdquo;, &ldquo;a&rdquo;}, {&ldquo;p&rdquo;, &ldquo;p&rdquo;}, {&ldquo;l&rdquo;, &ldquo;e&rdquo;}, {&ldquo;e&rdquo;, &ldquo;r&rdquo;}]</p>
</blockquote>
<ul>
<li>Now <em>map_reduce</em> this list, starting with a frequency count of the letters (accumulator) and then comparing each pair while reducing the letter count in the accumulator. Notice the accumulator remove letters at each step.</li>
</ul>
<blockquote>
<p>{&ldquo;a&rdquo;, &ldquo;p&rdquo;}, %{&ldquo;a&rdquo; =&gt; 1, &ldquo;e&rdquo; =&gt; 1, &ldquo;p&rdquo; =&gt; 2, &ldquo;r&rdquo; =&gt; 1} -&gt; {&ldquo;a&rdquo;, :wrong_position}<br>
{&ldquo;p&rdquo;, &ldquo;a&rdquo;}, %{&ldquo;a&rdquo; =&gt; 0, &ldquo;e&rdquo; =&gt; 1, &ldquo;p&rdquo; =&gt; 2, &ldquo;r&rdquo; =&gt; 1} -&gt; {&ldquo;p&rdquo;, :wrong_position}<br>
{&ldquo;p&rdquo;, &ldquo;p&rdquo;}, %{&ldquo;a&rdquo; =&gt; 0, &ldquo;e&rdquo; =&gt; 1, &ldquo;p&rdquo; =&gt; 1, &ldquo;r&rdquo; =&gt; 1} -&gt; {&ldquo;p&rdquo;, :correct}<br>
{&ldquo;l&rdquo;, &ldquo;e&rdquo;}, %{&ldquo;a&rdquo; =&gt; 0, &ldquo;e&rdquo; =&gt; 1, &ldquo;p&rdquo; =&gt; 0, &ldquo;r&rdquo; =&gt; 1} -&gt; {&ldquo;l&rdquo;, :wrong_letter}<br>
{&ldquo;e&rdquo;, &ldquo;r&rdquo;}, %{&ldquo;a&rdquo; =&gt; 0, &ldquo;e&rdquo; =&gt; 1, &ldquo;p&rdquo; =&gt; 0, &ldquo;r&rdquo; =&gt; 1} -&gt; {&ldquo;e&rdquo;, :wrong_position}</p>
</blockquote>
<p>This works remarkably well most of the time. I did start to notice some bugs and had to find a specific case so I could analyze and make changes. Given a guess &ldquo;rigid&rdquo; for the answer &ldquo;strip&rdquo; the first &lsquo;i&rsquo; gets marked as <em>:wrong_position</em> when it should be <em>:wrong_letter</em> instead as there is only one &lsquo;i&rsquo; and it is correct in the second occurance. To fix this we first allow underflows in the letter frequency accumulator and then go back and correct for those underflows. In this case the first &lsquo;i&rsquo; would initially be marked <em>:wrong_position</em>, the second &lsquo;i&rsquo; would get marked <em>:wrong_letter</em>, and then after we adjust the underflows we will get <em>:wrong_letter</em> followed by <em>:correct</em>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-elixir" data-lang="elixir"><span class="line"><span class="cl">  <span class="na">@spec</span> <span class="n">compare_letters</span><span class="p">(</span><span class="nc">String</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="nc">String</span><span class="o">.</span><span class="n">t</span><span class="p">)</span> <span class="o">::</span> <span class="n">list</span>
</span></span><span class="line"><span class="cl">  <span class="kd">def</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">answer</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">answer_letters</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="n">graphemes</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">guess_letters</span> <span class="o">=</span> <span class="nc">String</span><span class="o">.</span><span class="n">graphemes</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="n">answers</span><span class="p">,</span> <span class="n">counts</span><span class="p">}</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">      <span class="nc">Enum</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">guess_letters</span><span class="p">,</span> <span class="n">answer_letters</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">map_reduce</span><span class="p">(</span><span class="n">letter_counts</span><span class="p">(</span><span class="n">answer</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="k">fn</span> <span class="n">pair</span><span class="p">,</span> <span class="n">counts</span> <span class="o">-&gt;</span> <span class="n">process_letter_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span> <span class="k">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># If we see a correct letter in the wrong position before the</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># correct postion we might incorrectly mark it as :wrong_position.</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># In the case of &#34;rigid&#34; for &#34;strip&#34; the first &#39;i&#39; gets marked as</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># :wrong_position when it should be :wrong_letter.</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># To fix this go through the answers, removing underflows</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#34;rigid&#34; for &#34;strip&#34;, first &#39;i&#39; should be :wrong_letter</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="n">adjusted</span><span class="p">,</span> <span class="n">_adjusted_counts</span><span class="p">}</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">      <span class="nc">Enum</span><span class="o">.</span><span class="n">map_reduce</span><span class="p">(</span><span class="n">answers</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="k">fn</span> <span class="n">letter_result</span><span class="p">,</span> <span class="n">counts</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="n">remove_underflows</span><span class="p">(</span><span class="n">letter_result</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span> <span class="k">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># return only the answers, not the counts</span>
</span></span><span class="line"><span class="cl">    <span class="n">adjusted</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">def</span> <span class="n">compare_letters</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">compare_letters</span><span class="p">(</span><span class="n">answer</span><span class="p">,</span> <span class="n">answer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span></code></pre></div><h3 id="sidenote">Sidenote</h3>
<p>Initially I wrote the following code to find each letter and create of map of how many were in the word:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-elixir" data-lang="elixir"><span class="line"><span class="cl"><span class="kd">def</span> <span class="n">letter_counts</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">word</span>
</span></span><span class="line"><span class="cl">  <span class="o">|&gt;</span> <span class="nc">String</span><span class="o">.</span><span class="n">graphemes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p">(%{},</span> <span class="k">fn</span> <span class="n">char</span><span class="p">,</span> <span class="n">acc</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="nc">Map</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="p">(</span><span class="n">acc</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">     <span class="k">end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><p>Naively proud, I was satisfied with the use of <em>Enum.reduce/3</em> and <em>Map.put/3</em> to process the word &ndash; this is <em>functional</em> huzzah! The experienced among you will realize (as I eventually did) that I had simply reinvented <em>Enum.frequencies/1</em>! Well, I yanked that and happily replaced it, which is almost always the better choice.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-elixir" data-lang="elixir"><span class="line"><span class="cl"><span class="kd">def</span> <span class="n">letter_counts</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="n">word</span>
</span></span><span class="line"><span class="cl">  <span class="o">|&gt;</span> <span class="nc">String</span><span class="o">.</span><span class="n">graphemes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="o">.</span><span class="n">frequencies</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><h3 id="making-a-guess">Making a Guess</h3>
<p>When making a guess we need to account for success and potential errors.</p>
<ul>
<li><strong>Correct answer</strong> &ndash; Returns <em>{:ok, puzzle}</em> tuple which contains the final state of the puzzle, including <em>state: :game_won</em>.</li>
<li><strong>Incorrect guess</strong> &ndash; Returns <em>{:ok, puzzle}</em> tuple with the puzzle containing <em>state: :playing</em> if more guesses are available or <em>state: :game_over</em> if all the guesses are exhausted.</li>
<li><strong>Bad input</strong> &ndash; Returns <em>{:error, :baby_dont_hurt_me}</em> when the input has the wrong length, isn&rsquo;t a string, is nil, etc.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-elixir" data-lang="elixir"><span class="line"><span class="cl">  <span class="na">@doc</span> <span class="sh">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="sh">  Make a guess with the given word
</span></span></span><span class="line"><span class="cl"><span class="sh">  Returns a tuple
</span></span></span><span class="line"><span class="cl"><span class="sh">    {:ok, puzzle} with guess and results appended to puzzle
</span></span></span><span class="line"><span class="cl"><span class="sh">    {:error, reason}
</span></span></span><span class="line"><span class="cl"><span class="sh">  &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">def</span> <span class="n">make_guess</span><span class="p">(%</span><span class="nc">Puzzle</span><span class="p">{</span><span class="ss">state</span><span class="p">:</span> <span class="ss">:playing</span><span class="p">}</span> <span class="o">=</span> <span class="n">puzzle</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nc">Guess</span><span class="o">.</span><span class="n">guess_word</span><span class="p">(</span><span class="n">guess</span><span class="p">,</span> <span class="n">puzzle</span><span class="o">.</span><span class="n">answer</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Correct guess will transition the puzzle to :game_won</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="ss">:correct</span><span class="p">,</span> <span class="n">guess_result</span><span class="p">}</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">puzzle</span>
</span></span><span class="line"><span class="cl">              <span class="o">|&gt;</span> <span class="n">change_state</span><span class="p">(</span><span class="ss">:game_won</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">              <span class="o">|&gt;</span> <span class="n">add_result</span><span class="p">(</span><span class="n">guess_result</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Incorrect guess will update the puzzle and check for :game_over</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="ss">:incorrect</span><span class="p">,</span> <span class="n">guess_result</span><span class="p">}</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="n">last_guess?</span><span class="p">(</span><span class="n">puzzle</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">          <span class="no">true</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">puzzle</span>
</span></span><span class="line"><span class="cl">                  <span class="o">|&gt;</span> <span class="n">change_state</span><span class="p">(</span><span class="ss">:game_over</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="o">|&gt;</span> <span class="n">add_result</span><span class="p">(</span><span class="n">guess_result</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">          <span class="no">false</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">add_result</span><span class="p">(</span><span class="n">puzzle</span><span class="p">,</span> <span class="n">guess_result</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Don&#39;t pass in garbage!</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_length</span><span class="p">}</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_length</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="n">_</span><span class="p">}</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:baby_dont_hurt_me</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">def</span> <span class="n">make_guess</span><span class="p">(</span><span class="n">_puzzle</span><span class="p">,</span> <span class="n">_guess</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:game_over</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span></code></pre></div><h3 id="verifying-a-guess">Verifying a Guess</h3>
<p>The error code is very simple and seemingly non-descriptive, but <em>make_guess/2</em> is meant to be paired with <em>verify_guess/2</em>. Calling this will either return <em>{:ok, puzzle}</em> to indicate it&rsquo;s ok to proceed, or it will return <em>{:error, reason}</em> to give feedback if the guess isn&rsquo;t a string, is the wrong length, isn&rsquo;t in our answer dictionary, or some other nefarious problem.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-elixir" data-lang="elixir"><span class="line"><span class="cl">  <span class="kd">def</span> <span class="n">verify_guess</span><span class="p">(%</span><span class="nc">Puzzle</span><span class="p">{</span><span class="ss">state</span><span class="p">:</span> <span class="ss">:playing</span><span class="p">}</span> <span class="o">=</span> <span class="n">puzzle</span><span class="p">,</span> <span class="n">guess</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="n">with</span>  <span class="no">true</span> <span class="o">&lt;-</span> <span class="n">is_binary</span><span class="p">(</span><span class="n">guess</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="na">@word_length</span><span class="p">}</span> <span class="o">&lt;-</span> <span class="n">verify_guess_length</span><span class="p">(</span><span class="n">guess</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="p">{</span><span class="ss">:dict</span><span class="p">,</span> <span class="no">true</span><span class="p">}</span> <span class="o">&lt;-</span> <span class="p">{</span><span class="ss">:dict</span><span class="p">,</span> <span class="nc">PuzzleDictionary</span><span class="o">.</span><span class="n">verify_word</span><span class="p">(</span><span class="n">guess</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">puzzle</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="no">false</span> <span class="o">-&gt;</span>                        <span class="c1"># didn&#39;t pass in a string</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_arguments</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_length</span><span class="p">}</span> <span class="o">-&gt;</span>    <span class="c1"># wrong length</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_length</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:dict</span><span class="p">,</span> <span class="no">false</span><span class="p">}</span> <span class="o">-&gt;</span>               <span class="c1"># guess not in the dictionary</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_word</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="n">_</span><span class="p">}</span> <span class="o">-&gt;</span>                  <span class="c1"># we should never, ever get here</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:baby_dont_hurt_me</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="kd">def</span> <span class="n">verify_guess</span><span class="p">(</span><span class="n">_puzzle</span><span class="p">,</span> <span class="n">_guess</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:game_over</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="kd">defp</span> <span class="n">verify_guess_length</span><span class="p">(</span><span class="n">guess</span><span class="p">)</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nc">Enum</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nc">String</span><span class="o">.</span><span class="n">graphemes</span><span class="p">(</span><span class="n">guess</span><span class="p">))</span> <span class="o">==</span> <span class="na">@word_length</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="ss">do</span><span class="p">:</span>   <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="na">@word_length</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="ss">else</span><span class="p">:</span> <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:invalid_length</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span></code></pre></div><h3 id="wrapping-up">Wrapping Up</h3>
<p>This was a fun problem to solve, not least because it stretched me differently than following a tutorial. It&rsquo;s also tempting to revert to ingrained habits of declarative and OOP thinking. Things that made this enjoyable (and easier):</p>
<ul>
<li>Creating the data structures.</li>
<li>Pattern matching for control flow.</li>
<li>Piping results to process data.</li>
<li>Using IEx to prototype function calls.</li>
</ul>
<p>I like the richness and easiness of combining maps, lists, tuples, and atoms to represent the problem and solution. When first looking at Elixir, atoms were alien; however one day it clicked that they were an <em>idea</em>, or <em>name</em>, or <em>label</em>, or <em>state</em>. I&rsquo;d never seen or dealt with tuples while coding so they felt off initially, but then I realized how they allow richer return values and data. The rich standard library functions to manipulate enums, maps, lists, strings, etc made using the data structures easy.</p>
<p>Pattern matching is next level stuff. It simplifies so much control flow, error handling, data fetching, etc. This is another thing that baffled me when initially learning Elixir and trying to process the symbols I saw in Elixir code since they don&rsquo;t mean the same thing as in C. When I finally understood it, I wondered why I&rsquo;d never seen it before.</p>
<p>Function pipelines take complex data flow and make it more readable. It sure beats nested function calls or endless temporary variables passed along to the next function.</p>
<p>Coming to understand <em>how</em> to use IEx has made learning Elixir much easier. LiveBook also helps a lot with working through an idea. Again, when first learning Elixir I was lost: &ldquo;how can I learn when all I have is a text editor and a command line and print statements?&rdquo; Somewhere I watched José working with IEx and LiveBook and had my ahah moment.</p>
<h3 id="whats-next">What&rsquo;s Next?</h3>
<p>Soon I will delve into the word dictionary, the <em>Possibles</em> module that helps the player find answers when stuck, and the <em>Game</em> that ties all the parts together.</p>
<hr>

        
          <div class="blog-tags">
            
              <a href="https://simplyimagined.github.io/tags/subtle/">subtle</a>&nbsp;
            
              <a href="https://simplyimagined.github.io/tags/puzzle/">puzzle</a>&nbsp;
            
              <a href="https://simplyimagined.github.io/tags/design/">design</a>&nbsp;
            
          </div>
        

        

        
          
            
          

          
                  <h4 class="see-also">See also</h4>
                  <ul>
                
                
                    <li><a href="/post/2023-09-03-debugging-subtle/">Finding the Fix</a></li>
                
                    <li><a href="/page/subtle/">Subtle</a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://simplyimagined.github.io/post/2023-05-20-gig-city-elixir/" data-toggle="tooltip" data-placement="top" title="Gig City Elixir">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://simplyimagined.github.io/post/2023-08-31-binary-clock/" data-toggle="tooltip" data-placement="top" title="Building a Clock With Nerves">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="simplyimagined.com">Dan Anderson</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2023
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://simplyimagined.github.io">Simply Imagined</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.117.0</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://simplyimagined.github.io/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://simplyimagined.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

